@page
@using System.Net
@using Generic.Abp.IdentityServer.Permissions
@using Generic.Abp.IdentityServer.Web.Navigation
@using Generic.Abp.IdentityServer.Web.Pages.IdentityServer.ApiResources
@using Generic.Abp.Jspreadsheet;
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Mvc.Localization
@using Volo.Abp.AspNetCore.Mvc.UI.Layout
@using Volo.Abp.IdentityServer.Localization
@model IndexModel
@inject IHtmlLocalizer<AbpIdentityServerResource> _l
@inject IAuthorizationService _authorization
@inject IPageLayout _pageLayout
@{
    _pageLayout.Content.Title = _l["ApiResources"].Value;
    _pageLayout.Content.BreadCrumb.Add(_l["Menu:IdentityServerManagement"].Value);
    _pageLayout.Content.MenuItemName = IdentityServerMenuNames.ApiResources;
}

@section styles {
    <abp-style-bundle name="Jspreadsheet"></abp-style-bundle>
}

@section scripts {
    <abp-script-bundle name="@typeof(IndexModel).FullName">
        <abp-script src="/Pages/identityServer/ApiResources/index.js" />
    </abp-script-bundle>
    <abp-script-bundle name="Jspreadsheet"></abp-script-bundle>
}

<abp-card id="apiResourcesWrapper">
    <abp-card-header>
        <abp-row>
            <abp-column size-md="_6">
                <abp-card-title>@_l["ApiResources"]</abp-card-title>
            </abp-column>
            <abp-column size-md="_6" class="text-right">
                @if (await _authorization.IsGrantedAsync(IdentityServerPermissions.ApiResources.Create))
                {
                    <abp-button button-type="Primary" name="CreateApiResource" text="@_l["NewApiResource"].Value" icon="plus" />
                }
            </abp-column>
        </abp-row>
    </abp-card-header>
    <abp-card-body>
        <table class="display nowrap" style="width:100%">
            <thead>
            <tr>
                <th>@_l["ApiResource:Name"]</th>
                <th>@_l["ApiResource:DisplayName"]</th>
                <th>@_l["ApiResource:Description"]</th>
                <th>@_l["ApiResource:Enabled"]</th>
                <th>@_l["ApiResource:AllowedAccessTokenSigningAlgorithms"]</th>
                <th>@_l["ApiResource:ShowInDiscoveryDocument"]</th>
                <th>@_l["Actions"]</th>
            </tr>
            </thead>
        </table>
    </abp-card-body>
</abp-card>

<abp-card id="ClaimsWrapper" style="display: none">
    <abp-card-header>
        <abp-row>
            <abp-column size-md="_6">
                <abp-card-title id="ClaimsTitle">@_l["Claims"]</abp-card-title>
            </abp-column>
            <abp-column size-md="_6" class="text-right">
                <abp-button button-type="Secondary" name="returnButton" text="@_l["Return"].Value" icon="chevron-left" />
                @if (await _authorization.IsGrantedAsync(IdentityServerPermissions.ApiResources.Update))
                {
                    <abp-button button-type="Primary" name="createButton" text="@_l["Claims"].Value" icon="plus" />
                }
            </abp-column>
        </abp-row>
    </abp-card-header>
    <abp-card-body>
        <table class="display nowrap" style="width:100%">
            <thead>
            <tr>
                <th>@_l["UserClaim:Type"]</th>
                <th>@_l["Actions"]</th>
            </tr>
            </thead>
        </table>
    </abp-card-body>
</abp-card>

<abp-card id="ScopesWrapper" style="display: none">
    <abp-card-header>
        <abp-row>
            <abp-column size-md="_6">
                <abp-card-title id="ScopesTitle">@_l["Claims"]</abp-card-title>
            </abp-column>
            <abp-column size-md="_6" class="text-right">
                <abp-button button-type="Secondary" name="returnButton" text="@_l["Return"].Value" icon="chevron-left" />
                @if (await _authorization.IsGrantedAsync(IdentityServerPermissions.ApiResources.Update))
                {
                    <abp-button button-type="Primary" name="createButton" text="@_l["Scopes"].Value" icon="plus" />
                }
            </abp-column>
        </abp-row>
    </abp-card-header>
    <abp-card-body>
        <table class="display nowrap" style="width:100%">
            <thead>
                <tr>
                    <th>@_l["Scopes"]</th>
                    <th>@_l["Actions"]</th>
                </tr>
            </thead>
        </table>
    </abp-card-body>
</abp-card>

<abp-card id="SecretsWrapper" style="display: none">
    <abp-card-header>
        <abp-row>
            <abp-column size-md="_6">
                <abp-card-title id="SecretsTitle">@_l["Secrets"]</abp-card-title>
            </abp-column>
            <abp-column size-md="_6" class="text-right">
                <abp-button button-type="Secondary" name="returnButton" text="@_l["Return"].Value" icon="chevron-left" />
                @if (await _authorization.IsGrantedAsync(IdentityServerPermissions.ApiResources.Update))
                {
                    <abp-button button-type="Primary" name="createButton" text="@_l["Secret"].Value" icon="plus" />
                }
            </abp-column>
        </abp-row>
    </abp-card-header>
    <abp-card-body>
        <table class="display nowrap" style="width:100%">
            <thead>
                <tr>
                    <th>@_l["Secrets:Type"]</th>
                    <th>@_l["Secrets:Value"]</th>
                    <th>@_l["Secrets:Description"]</th>
                    <th>@_l["Secrets:Expiration"]</th>
                    <th>@_l["Actions"]</th>
                </tr>
            </thead>
        </table>
    </abp-card-body>
</abp-card>
